# Sensoru PƒÅrvaldes Sistƒìma

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞–º–∏ —Å FastAPI backend –∏ React frontend.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ backend/          # FastAPI MVC –±—ç–∫–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/   # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/        # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers/       # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py    # SQLAlchemy –º–æ–¥–µ–ª–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt   # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ run.bat           # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (Windows)
‚îú‚îÄ‚îÄ frontend/         # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/    # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/         # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/         # Zustand stores
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.jsx        # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ package.json       # Node –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.js     # Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ arduino/          # ESP32 –∫–æ–¥ –¥–ª—è –¥–∞—Ç—á–∏–∫–æ–≤
    ‚îî‚îÄ‚îÄ esp32_scd41.ino
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Backend (FastAPI)

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
cd backend
python -m venv venv
.\venv\Scripts\Activate.ps1  # Windows PowerShell
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ `backend/app/config.py`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase PostgreSQL
   - –¢–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ SQL —Å—Ö–µ–º–µ (—Å–º. —Ä–∞–∑–¥–µ–ª –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

3. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
cd backend
.\venv\Scripts\Activate.ps1
uvicorn app.main:app --reload --port 8000
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `run.bat`:
```bash
cd backend
run.bat
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8000`
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger): `http://localhost:8000/docs`
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (ReDoc): `http://localhost:8000/redoc`

### Frontend (React + Vite)

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
cd frontend
npm install
```

2. **–ó–∞–ø—É—Å–∫:**
```bash
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://localhost:5173`

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü (PostgreSQL)

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase:

1. **users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
2. **device_info** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
3. **device_users** - –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
4. **measurements** - –ò–∑–º–µ—Ä–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤

–ü–æ–ª–Ω–∞—è SQL —Å—Ö–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ 3NF (—Å–º. –ø—Ä–µ–¥—ã–¥—É—â–∏–π SQL –ø—Ä–æ–º–ø—Ç).

## üîê API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/api/auth`)

- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  ```json
  {
    "email": "user@example.com",
    "username": "username",
    "password": "password123"
  }
  ```

- `POST /api/auth/login` - –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  ```json
  {
    "email": "user@example.com",
    "password": "password123"
  }
  ```
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω.

- `GET /api/auth/me` - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (`/api/devices`)

- `GET /api/devices` - –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

- `POST /api/devices` - –î–æ–±–∞–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
  ```json
  {
    "mac_address": "AA:BB:CC:DD:EE:FF",
    "device_name": "–î–∞—Ç—á–∏–∫ –∫–æ–º–Ω–∞—Ç–∞ 1"
  }
  ```

- `DELETE /api/devices/{mac_address}` - –£–¥–∞–ª–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

### –ò–∑–º–µ—Ä–µ–Ω–∏—è (`/api/measurements`)

- `GET /api/measurements/device/{mac_address}?limit=100` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

- `POST /api/measurements/receive` - –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç ESP32 (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
  ```json
  {
    "device_id": "AA:BB:CC:DD:EE:FF",
    "temperature": 22.5,
    "humidity": 65.3,
    "co2": 450.0
  }
  ```

## üîß ESP32 Integration

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å ESP32 –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/measurements/receive`:

```cpp
// –ü—Ä–∏–º–µ—Ä –¥–ª—è Arduino/ESP32
HTTPClient http;
http.begin("http://your-server:8000/api/measurements/receive");
http.addHeader("Content-Type", "application/json");

String payload = "{\"device_id\":\"" + macAddress + 
                 "\",\"temperature\":" + String(temperature) + 
                 ",\"humidity\":" + String(humidity) + 
                 ",\"co2\":" + String(co2) + "}";

int httpCode = http.POST(payload);
http.end();
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–º. –≤ `arduino/esp32_scd41.ino`

## üé® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –§—Ä–æ–Ω—Ç–µ–Ω–¥
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ MAC –∞–¥—Ä–µ—Å—É
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ—Ä–µ–Ω–∏–π –¥–∞—Ç—á–∏–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Recharts)
- ‚úÖ –¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞
- ‚úÖ –õ–∞—Ç—ã—à—Å–∫–∏–π —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –ë—ç–∫–µ–Ω–¥
- ‚úÖ MVC –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger/ReDoc)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ó–∞—â–∏—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ OAuth2PasswordBearer
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö origin'–æ–≤

## üìù –ó–∞–º–µ—Ç–∫–∏

- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase —Å–æ–∑–¥–∞–Ω—ã
- –ë—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä–∞–±–æ—Ç—É —Å `http://localhost:8000`
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç–µ `SECRET_KEY` –≤ `backend/app/config.py`

## üêõ –û—Ç–ª–∞–¥–∫–∞

### Backend
- –õ–æ–≥–∏ uvicorn –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ `/docs`

### Frontend
- –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ `frontend/src/services/api.js`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

